<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Analytics Dashboard</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header class="header">
        <div class="brand">
            <div class="logo-section">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div>
                    <h1>Measles Immunization Gap Analysis</h1>
                    <p>MCV1 Coverage Monitoring (2022 - 2024)</p>
                </div>
            </div>
        </div>
        
        <div class="global-controls">
            <span class="global-label">Global Context:</span>
            <select id="year-filter">
                <option value="All">All Years (Latest Snapshot)</option>
                </select>
        </div>
    </header>

    <div class="metrics-container" id="metrics-container">
        </div>

    <div class="visualization-container">
        
        <div class="chart-box main-col">
            <div class="chart-header">
                <div>
                    <h2>Global Coverage Map</h2>
                    <span id="map-year-label" class="meta">(Latest Available)</span>
                </div>
                <button id="reset-zoom" class="btn-small">Reset Zoom</button>
            </div>
            
            <div id="choropleth-map">
                <div id="map-info">
                    <h3 id="info-country">Hover Country</h3>
                    <div id="info-rate" class="rate-large">--%</div>
                    <div id="info-year" style="font-size:0.8rem; color:#64748b;">Year: --</div>
                </div>

                <div id="map-legend" class="map-overlay-legend">
                    <div class="legend-item"><span class="dot l-green"></span> â‰¥ 95% (Target)</div>
                    <div class="legend-item"><span class="dot l-yellow-green"></span> 90% - 94%</div>
                    <div class="legend-item"><span class="dot l-yellow"></span> 80% - 89%</div>
                    <div class="legend-item"><span class="dot l-yellow-orange"></span> 70% - 79%</div>
                    <div class="legend-item"><span class="dot l-orange"></span> 60% - 69%</div>
                    <div class="legend-item"><span class="dot l-red-orange"></span> 50% - 59%</div>
                    <div class="legend-item"><span class="dot l-red"></span> &lt; 50%</div>
                    <div class="legend-item"><span class="dot l-gray"></span> No Data</div>
                </div>
            </div>
        </div>

        <div class="chart-box side-col">
            <div class="chart-header">
                <h2>Lowest Immunization Rates (Top 10)</h2>
            </div>
            <div id="bar-chart"></div>
            <p class="caption">Countries needing urgent intervention.</p>
        </div>

        <div class="chart-box main-col">
            <div class="chart-header">
                <h2>
                    <svg class="section-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 3H21V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M4 20L21 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 16V21H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M15 15L9 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M4 4L9 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Measles Immunization Gap Comparison
                </h2>
                <span class="meta">Compare historical performance</span>
            </div>
            
            <div class="comparison-ui">
                <div class="comparison-controls">
                    <select id="country-select-dropdown">
                        <option value="" disabled selected>Search/Select Country...</option>
                    </select>
                    <button id="add-country-btn" class="btn-primary">+ Add</button>
                    <button id="clear-comparison-btn" class="btn-secondary">Clear</button>
                </div>
                
                <div id="selected-countries-list" class="tags-container"></div>
                
                <div class="comparison-layout">
                    <div id="comparison-chart" class="comp-chart">
                        Select countries to visualize trends.
                    </div>
                    <div id="comparison-table-container" class="comp-table"></div>
                </div>
            </div>
        </div>

        <div class="chart-box side-col">
            <div class="chart-header">
                <h2>Coverage Distribution</h2>
            </div>
            <div id="pie-chart"></div>
            <p class="caption">Count of countries per coverage range.</p>
            <div id="pie-legend" class="pie-legend"></div>
        </div>

        <div class="chart-box full-width">
            <div class="chart-header">
                <h2>
                    <svg class="section-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 6H21M3 12H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 6V18M15 6V18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Detailed Data of Immunization Rate
                </h2>
                <span class="meta">Search and filter the complete dataset</span>
            </div>
            
            <div class="controls-row">
                <input type="text" id="search-input" placeholder="Search by Country Name...">
                <select id="table-year-filter">
                    <option value="All">Filter by Year: All</option>
                </select>
                <select id="region-filter">
                    <option value="All">Filter by Region: All</option>
                </select>
                <button id="download-csv-btn" class="btn-download">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Download CSV
                </button>
            </div>

            <div id="summary-table"></div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>